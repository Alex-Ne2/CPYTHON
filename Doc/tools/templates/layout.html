{% extends "!layout.html" %}

{% block header %}
{%- if outdated %}
<div id="outdated-warning" style="padding: .5em; text-align: center; background-color: #FFBABA; color: #6A0E0E;">
    {% trans %}This document is for an old version of Python that is no longer supported.
    You should upgrade, and read the{% endtrans %}
    <a href="/3/{{ pagename }}{{ file_suffix }}">{% trans %}Python documentation for the current stable release{% endtrans %}</a>.
</div>
{%- endif %}

{%- if is_deployment_preview %}
<div id="deployment-preview-warning" style="padding: .5em; text-align: center; background-color: #fff2ba; color: #6a580e;">
  {% trans %}This is a deploy preview created from a <a href="{{ repository_url }}/pull/{{ pr_id }}">pull request</a>.
  For authoritative documentation, see{% endtrans %}
  <a href="https://docs.python.org/3/{{ pagename }}{{ file_suffix }}">{% trans %}the current stable release{% endtrans %}</a>.
</div>
{%- endif %}
{% endblock %}

{% block rootrellink %}
{{ super() }}
    <li id="cpython-language-and-version">
      <a href="{{ pathto('index') }}">{{ shorttitle }}</a>{{ reldelim1 }}
    </li>
{% endblock %}

{% block extrahead %}
    <link rel="canonical" href="https://docs.python.org/3/{{pagename}}.html" />
    {% if builder != "htmlhelp" %}
      {% if pagename == 'whatsnew/changelog' and not embedded %}
      <script type="text/javascript" src="{{ pathto('_static/changelog_search.js', 1) }}"></script>{% endif %}
    {% endif %}

    {# custom CSS; used in asyncio docs! #}
    <style>
      @media only screen {{ "{" }}
        table.full-width-table {{ "{" }}
            width: 100%;
        {{ "}" }}
      {{ "}" }}
    </style>
{{ super() }}

<meta name="readthedocs-addons-api-version" content="0">
<script type="text/javascript">
 function onSwitch(event) {
     const option = event.target.selectedIndex;
     const item = event.target.options[option];
     window.location.href = item.dataset.url;
 }

 document.addEventListener("readthedocs-addons-data-ready", function(event) {
     const config = event.detail;
     const languageMapping = {
         en: "English",
         es: "Spanish",
         // ...
     }

     // TODO: add `selected="selected"` to option
     const versionSelect = `
     <select id="version_select">
     ${ config.addons.flyout.versions.map(
         (version) => `
           <option
               value="${ version.slug }"
               ${ config.versions.current.slug === version.slug ? 'selected="selected"' : '' }
               data-url="${ version.url }">
               ${ version.slug }
           </option>`
     ).join("\n") }
     </select>
     `;

     const languageSelect = `
     <select id="language_select">
     ${ config.addons.flyout.translations.map(
         (translation) => `
         <option
             value="${ translation.slug }"
             ${ config.projects.current.language.code === translation.slug ? 'selected="selected"' : '' }
             data-url="${ translation.url }">
             ${ languageMapping[translation.slug] }
         </option>`
     ).join("\n") }
     </select>
     `;

    const selectVersionElement = document.querySelector("li.switchers div.version_switcher_placeholder");
    selectVersionElement.innerHTML = versionSelect;
    document.querySelector("li.switchers div.version_switcher_placeholder").addEventListener("change", onSwitch);

    const selectLanguageElement = document.querySelector("li.switchers div.language_switcher_placeholder");
    selectLanguageElement.innerHTML = languageSelect;
    document.querySelector("li.switchers div.language_switcher_placeholder select").addEventListener("change", onSwitch);
 });
</script>
{% endblock %}
