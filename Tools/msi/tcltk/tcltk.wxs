<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*" Language="!(loc.LCID)" Name="!(loc.Title)" Version="$(var.Version)" Manufacturer="!(loc.Manufacturer)" UpgradeCode="$(var.UpgradeCode)">
        <Package InstallerVersion="300" Compressed="yes" InstallScope="perUser" Platform="$(var.Platform)" />
        <MediaTemplate EmbedCab="yes" CompressionLevel="high" />
        
        <PropertyRef Id="UpgradeTable" />
        <PropertyRef Id="REGISTRYKEY" />
        
        <Property Id="PYTHON_EXE" Secure="yes">
            <ComponentSearch Id="PythonExe" Guid="$(var.PythonExeComponentGuid)">
                <FileSearch Name="python.exe" />
            </ComponentSearch>
        </Property>
        
        <Property Id="PYTHONW_EXE" Secure="yes">
            <ComponentSearch Id="PythonwExe" Guid="$(var.PythonwExeComponentGuid)">
                <FileSearch Name="pythonw.exe" />
            </ComponentSearch>
        </Property>
        
        <Condition Message="!(loc.NoPython)">PYTHON_EXE and PYTHONW_EXE</Condition>

        <Feature Id="DefaultFeature" AllowAdvertise="no" Title="!(loc.Title)" Description="!(loc.Description)">
            <ComponentGroupRef Id="tkinter_extension" />
            <ComponentGroupRef Id="tcltk_dlls" />
            <ComponentGroupRef Id="tcltk_lib" />
            <ComponentGroupRef Id="tkinter_lib" Primary="yes" />
            <ComponentRef Id="OptionalFeature" />
        </Feature>
        <Feature Id="AssociateFiles" AllowAdvertise="no" Title="!(loc.Title)" Description="!(loc.Description)">
            <ComponentGroupRef Id="tkinter_lib" />
        </Feature>
    </Product>
</Wix>
