Optimize set creation and set updating by using a length (hint) in the general case. Patch by Jeremiah Pascual.
