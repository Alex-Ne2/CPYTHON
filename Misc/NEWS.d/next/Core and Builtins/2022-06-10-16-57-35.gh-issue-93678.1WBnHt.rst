Refactor the compiler's code-gen functions to reduce boilerplate and
repetition.
