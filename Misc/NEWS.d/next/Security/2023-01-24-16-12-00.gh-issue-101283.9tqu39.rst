Make ``shell=True`` mode of :meth:`subprocess.Popen.__init__` resilient
to a spoof of ``cmd.exe``. Patch by Eryk Sun.
