Fixed the block to guarantee that the length of a write to a pipe is not greater than `PIPE_BUF`
